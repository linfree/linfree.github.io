<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="baidu-site-verification" content="1EB8XoOl0C"><title> SQLAlchemy的属性介绍 · 静思地</title><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="SQLAlchemy的属性介绍"><meta name="keywords" content="python SQLAlchemy"><meta name="author" content="Lin Free"><link rel="short icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/bubuzou.css"><link rel="search" type="application/opensearchdescription+xml" href="http://blog.fbi.st/atom.xml" title="静思地"></head><body><header><div class="header row"> <a href="http://fbi.st/" class="logo-link"><img src="/images/logo.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" data-hover="博文" class="nav-list-link">博文</a></li><li class="nav-list-item"><a href="/archives/" target="_self" data-hover="归档" class="nav-list-link">归档</a></li><li class="nav-list-item"><a href="/categories/live/" target="_self" data-hover="生活" class="nav-list-link">生活</a></li><li class="nav-list-item"><a href="/categories/read/" target="_self" data-hover="读书" class="nav-list-link">读书</a></li><li class="nav-list-item"><a href="/about/" target="_self" data-hover="关于" class="nav-list-link">关于</a></li></ul><div class="search"><a id="search_btn" href="#search"></a></div></div></header><div class="row scroll-con"><section class="container"><!-- for archive page--><div id="postAr" class="post"><article class="post-block"><h1 class="post-title">SQLAlchemy的属性介绍</h1><div class="post-info">2018-09-26 21:20</div><div class="post-content"><h2 id="SQLAlchemy的应用"><a href="#SQLAlchemy的应用" class="headerlink" title="SQLAlchemy的应用"></a>SQLAlchemy的应用</h2><h3 id="行数据类型"><a href="#行数据类型" class="headerlink" title="行数据类型"></a>行数据类型</h3><table>
<thead>
<tr>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Integer</td>
<td>整数</td>
</tr>
<tr>
<td>String (size)</td>
<td>有最大长度的字符串</td>
</tr>
<tr>
<td>Text</td>
<td>长 unicode 文本</td>
</tr>
<tr>
<td>Date</td>
<td>表示为日期</td>
</tr>
<tr>
<td>DateTime</td>
<td>表示为 datetime 对象 的时间和日期</td>
</tr>
<tr>
<td>Float</td>
<td>存储浮点值</td>
</tr>
<tr>
<td>Boolean</td>
<td>存储布尔值</td>
</tr>
<tr>
<td>PickleType</td>
<td>存储一个持久化 Python 对象</td>
</tr>
<tr>
<td>LargeBinary</td>
<td>存储任意大的二进制数据</td>
</tr>
</tbody>
</table>
<a id="more"></a>
<h3 id="其他行属性"><a href="#其他行属性" class="headerlink" title="其他行属性"></a>其他行属性</h3><p><code>primary_key=True</code> 是否是主键<br><code>db.ForeignKey(&#39;person.id&#39;)</code> 表示设置XX表名.XX字段名外键<br><code>nullable=False</code> 是否能为空<br><code>unique=True</code> 是否能重复<br><code>autoincrement=True</code> 是否自增长<br><code>default=0</code> 默认值<br><code>index=True</code> 索引<br><code>name</code> 名称<br><code>type_</code> 列类型</p>
<h3 id="关系链接"><a href="#关系链接" class="headerlink" title="关系链接"></a>关系链接</h3><p>一对多的关系：  </p>
<p>如果要表示一对一的关系，在定义<code>relationship</code> 的时候设置<code>uselist</code> 为<code>False</code> （默认为<code>True</code> ）</p>
<p><code>db.relationship(&#39;Teams&#39;)</code> 定义一个关系<br><code>backref=db.backref(&#39;users&#39;)</code> 反向引用<br><code>primaryjoin=&#39;Persion.like_id==Book.id&#39;</code> 多个外键的情况</p>
<p>多对多的关系有中间表：</p>
<p><code>secondary = 中间表模型,</code> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tags = db.Table(&apos;tags&apos;,</span><br><span class="line">    db.Column(&apos;tag_id&apos;, db.Integer, db.ForeignKey(&apos;tag.id&apos;)),</span><br><span class="line">    db.Column(&apos;page_id&apos;, db.Integer, db.ForeignKey(&apos;page.id&apos;))</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">class Page(db.Model):</span><br><span class="line">    id = db.Column(db.Integer, primary_key=True)</span><br><span class="line">    tags = db.relationship(&apos;Tag&apos;, secondary=tags,</span><br><span class="line">        backref=db.backref(&apos;pages&apos;, lazy=&apos;dynamic&apos;))</span><br><span class="line"></span><br><span class="line">class Tag(db.Model):</span><br><span class="line">    id = db.Column(db.Integer, primary_key=True)</span><br></pre></td></tr></table></figure>
<p><code>secondary=association_table,
        back_populates=&quot;children&quot;</code>   </p>
<p>循环一对多关系<br>还是我自己写的Persion和Book关系，一个人可能写过多本书，一本Book只有一个Persion写，N个人最喜欢1个书，每个人只能有一个最喜欢的这个例子可能不大恰当，<br>但是就是两个单向的一对多关系，是不能用多对多关系的，<br>下面是我给出的例子<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Persion</span><span class="params">(Base)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'persion'</span></span><br><span class="line">    id = Column(Integer, autoincrement=<span class="literal">True</span>, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = Column(String(<span class="number">1024</span>))</span><br><span class="line">    like_id = Column(Integer, ForeignKey(<span class="string">'book.id'</span>))</span><br><span class="line">    books = relationship(<span class="string">'Book'</span>, backref=<span class="string">'auther'</span>, lazy=<span class="string">"dynamic"</span>,</span><br><span class="line">                         primaryjoin=<span class="string">'Book.auther_id==Persion.id'</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Book</span><span class="params">(Base)</span>:</span></span><br><span class="line">    __tablename__ = <span class="string">'book'</span></span><br><span class="line">    id = Column(Integer, autoincrement=<span class="literal">True</span>, primary_key=<span class="literal">True</span>)</span><br><span class="line">    likes = relationship(<span class="string">'Persion'</span>, backref=<span class="string">'like'</span>, lazy=<span class="string">"dynamic"</span>,</span><br><span class="line">                         primaryjoin=<span class="string">'Persion.like_id==Book.id'</span>)</span><br><span class="line">    name = Column(String(<span class="number">1024</span>))</span><br><span class="line">    auther_id = Column(Integer, ForeignKey(<span class="string">'persion.id'</span>))</span><br></pre></td></tr></table></figure></p>
<p>主要是添加<code>primaryjoin</code> 属性，说明关联的字段<br>在使用sqlalchemy的时候有很多属性，类似<code>lazy</code> ，<code>backref</code> ，<code>primaryjoin</code> 这样的属性，备选项很多，需要多多查询官方文档。只有使用过过才会比较熟悉</p>
<h3 id="表的引擎和编码"><a href="#表的引擎和编码" class="headerlink" title="表的引擎和编码"></a>表的引擎和编码</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Table(<span class="string">'mytable'</span>, metadata,</span><br><span class="line">      Column(<span class="string">'data'</span>, String(<span class="number">32</span>)),</span><br><span class="line">      mysql_engine=<span class="string">'InnoDB'</span>,</span><br><span class="line">      mysql_charset=<span class="string">'utf8'</span>,</span><br><span class="line">      mysql_key_block_size=<span class="string">"1024"</span></span><br><span class="line">     )</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">或</span><br><span class="line">```py</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(Base)</span>:</span></span><br><span class="line">    <span class="string">"""Users table"""</span></span><br><span class="line">    <span class="comment"># 表的名字</span></span><br><span class="line">    __tablename__=<span class="string">'users'</span></span><br><span class="line">    __table_args__=&#123;<span class="string">'sqlite_autoincrement'</span>: <span class="literal">True</span>,<span class="string">'mysql_engine'</span>: <span class="string">'InnoDB'</span>,<span class="string">'mysql_charset'</span>: <span class="string">'utf8'</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 表结构</span></span><br><span class="line">    id=Column(Integer,primary_key=<span class="literal">True</span>,autoincrement=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
</div></article></div><div class="right-container"><div class="widget"><div class="category"><h4>分类归档</h4><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Elasticsearch非权威指南/">Elasticsearch非权威指南</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/leetcode/">leetcode</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/live/">live</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/php/">php</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/read/">read</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/">tools</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a><span class="category-list-count">7</span></li></ul></div></div><div class="widget"><div class="tagcloud"><h4>标签云</h4><a href="/tags/Elasticsearch/" style="font-size: 18px;">Elasticsearch</a> <a href="/tags/Hadoop/" style="font-size: 12px;">Hadoop</a> <a href="/tags/Linux/" style="font-size: 14px;">Linux</a> <a href="/tags/MySQL/" style="font-size: 14px;">MySQL</a> <a href="/tags/Mysql/" style="font-size: 14px;">Mysql</a> <a href="/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/leetcode/" style="font-size: 10px;">leetcode</a> <a href="/tags/php/" style="font-size: 20px;">php</a> <a href="/tags/python/" style="font-size: 16px;">python</a> <a href="/tags/tools/" style="font-size: 12px;">tools</a> <a href="/tags/数据库/" style="font-size: 16px;">数据库</a> <a href="/tags/生活/" style="font-size: 16px;">生活</a> <a href="/tags/电影/" style="font-size: 12px;">电影</a> <a href="/tags/读书笔记/" style="font-size: 10px;">读书笔记</a></div></div><div class="widget"><div class="recent"><h4>最近文章</h4><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/10/10/一段优雅的高级正则打开[断言]之门/">一段优雅的高级正则打开[断言]之门</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/09/匹配IPv4的最强正则/">匹配IPv4的最强正则</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/19/elasticsearch常用查询整理/">elasticsearch常用查询整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/20/《如何阅读一本书》读书笔记/">《如何阅读一本书》读书笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/27/mysql通过触发器远程同步/">mysql通过触发器远程同步</a></li></ul></div></div><div class="widget"><div id="arAnchorBar"></div></div></div></section></div><div class="right-menu"></div><div class="modal search-modal"><div class="input-field"><input type="text" id="search_input"><label for="search-input">搜索</label></div><div id="search_result" class="search-result"></div></div><div class="blog-overlay"></div><footer class="row"><div class="footer-con"><div class="paginator"><a href="/2018/10/20/看完《我不是药神》后我用python分析了中国的药店/" class="prev">PREV</a><a href="/2018/09/23/SQLAlchemy的基本操作/" class="next">NEXT</a></div><div id="lv-container" data-id="city" data-uid="MTAyMC80MDQ4MC8xNzAwNw=="></div><script type="text/javascript">(function(d, s) {
var j, e = d.getElementsByTagName(s)[0];
if (typeof LivereTower === 'function') { return; }
j = d.createElement(s);
j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
j.async = true;
e.parentNode.insertBefore(j, e);
})(document, 'script');</script><noscript> 为正常使用来必力评论功能请激活JavaScript</noscript><div class="copyright"><p>© 2017 - 2019 <a target="_blank">Lin Free</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> <br> and <a href="https://github.com/linfree/hexo-theme-bubuzou" target="_blank">hexo-theme-bubuzou</a>.</p></div><div class="totop"><i></i></div></div></footer><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script src="/scripts/jquery-1.8.2.min.js"></script><script src="/scripts/arAnchor.js"></script><script src="/scripts/main.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>